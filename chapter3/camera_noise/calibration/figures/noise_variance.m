% NOTE: two figures generated by this script can NOT be correctly converted
% to .wmf files (lose all vector elements and become bitmap images after
% inserting into MS Word, I don't know why, perhaps because of the subplot
% function?), so export as .tiff instead.
% Fuck the MS Word!

%% show noise map (sigma_N^2) for NIKON D3x

clear; close all; clc;

data_path = load('global_data_path.mat');

load(fullfile(data_path.path, 'noise_calibration\NIKON_D3x\sigmaN_estimates.mat'));

cmap = flipud(brewermap(128, 'RdBu'));

hfig = figure('color', 'w', 'unit', 'centimeters', 'position', [5, 1, 14, 26]);

hax1 = subplot('Position', [-.05, .8, .95, .185]);
hax2 = subplot('Position', [-.05, .605, .95, .185]);
hax3 = subplot('Position', [-.05, .41, .95, .185]);
hax4 = subplot('Position', [-.05, .215, .95, .185]);
hax5 = subplot('Position', [-.05, .02, .95, .185]);

% cut off the edges
tmp1 = sigmaN_estimates.EXP8_ISO100_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp1), [log(5E2), log(1E5)], 'parent', hax1);
text(hax1, -0.15, .5, 'ISO100',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');

tmp2 = sigmaN_estimates.EXP15_ISO200_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp2), [log(5E2), log(1E5)], 'parent', hax2);
text(hax2, -0.15, .5, 'ISO200',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');
 
tmp3 = sigmaN_estimates.EXP30_ISO400_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp3), [log(5E2), log(1E5)], 'parent', hax3);
text(hax3, -0.15, .5, 'ISO400',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');
 
tmp4 = sigmaN_estimates.EXP60_ISO800_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp4), [log(5E2), log(1E5)], 'parent', hax4);
text(hax4, -0.15, .5, 'ISO800',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');

tmp5 = sigmaN_estimates.EXP125_ISO1600_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp5), [log(5E2), log(1E5)], 'parent', hax5);
text(hax5, -0.15, .5, 'ISO1600',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');
 
colormap(cmap);
ticks = [log(5E2), log(1E3), log(2E3), log(5E3), log(1E4), log(2E4), log(5E4), log(1E5)];
colorbar('ticks', ticks,...
         'ticklabels', cellfun(@(x)sprintf('%.3G', x), num2cell(exp(ticks)), 'UniformOutput', false'),...
         'linewidth', 2, 'position', [.76 .02 .04 .964]);
set(gca, 'fontname', 'Times New Roman', 'fontsize', 20);


%% show noise map (sigma_N^2) for SONY ILCE7
clearvars -except data_path cmap

load(fullfile(data_path.path, 'noise_calibration\ILCE7\sigmaN_estimates.mat'));

hfig = figure('color', 'w', 'unit', 'centimeters', 'position', [5, 1, 14, 26]);

hax1 = subplot('Position', [-.05, .8, .95, .185]);
hax2 = subplot('Position', [-.05, .605, .95, .185]);
hax3 = subplot('Position', [-.05, .41, .95, .185]);
hax4 = subplot('Position', [-.05, .215, .95, .185]);
hax5 = subplot('Position', [-.05, .02, .95, .185]);

% cut off the edges
tmp1 = sigmaN_estimates.EXP8_ISO100_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp1), [log(40), log(3000)], 'parent', hax1);
text(hax1, -0.15, .5, 'ISO100',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');

tmp2 = sigmaN_estimates.EXP15_ISO200_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp2), [log(40), log(3000)], 'parent', hax2);
text(hax2, -0.15, .5, 'ISO200',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');
 
tmp3 = sigmaN_estimates.EXP30_ISO400_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp3), [log(40), log(3000)], 'parent', hax3);
text(hax3, -0.15, .5, 'ISO400',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');
 
tmp4 = sigmaN_estimates.EXP60_ISO800_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp4), [log(40), log(3000)], 'parent', hax4);
text(hax4, -0.15, .5, 'ISO800',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');
 
tmp5 = sigmaN_estimates.EXP125_ISO1600_F4_55mm(11:2:end-10, 11:2:end-10, 2);
imshow(log(tmp5), [log(40), log(3000)], 'parent', hax5);
text(hax5, -0.15, .5, 'ISO1600',...
     'fontname', 'Times New Roman', 'fontsize', 20,...
     'rotation', 90, 'horizontalalignment', 'center', 'Units', 'normalized');
 
colormap(cmap);
ticks = [log(40), log(100), log(200), log(400), log(800), log(1500), log(3000)];
colorbar('ticks', ticks,...
         'ticklabels', cellfun(@(x)sprintf('%.4G', x), num2cell(exp(ticks)), 'UniformOutput', false'),...
         'linewidth', 2, 'position', [.76 .02 .04 .964]);
set(gca, 'fontname', 'Times New Roman', 'fontsize', 20);
